define(["require"],function(require){function Toolbox(){console&&console.log("WARNING: You do not need to call new Toolbox(). You can use it directly, e.g., Toolbox.addClass(...)")}return Toolbox.reduce=function(e,t,n){var r="";for(var i=0;i<e.length;i++)i>0&&(r+=t),n!=null?r+=n(e[i]):r+=e[i];return r},Toolbox.addClass=function(e,t){if(e==null){console&&console.log("ERROR: Toolbox.addClass with null element");return}if(e.length==null||e.value!=null)e=[e];Toolbox.removeClass(e,t);for(var n=0;n<e.length;n++)e[n].className+=" "+t},Toolbox.removeClass=function(e,t){if(e==null){console&&console.log("Called removeClass with null element"),console&&console.trace();return}if(e.length==null||e.value!=null)e=[e];for(var n=0;n<e.length;n++){var r=e[n];if(r.className==null)return;var i=r.className.split(" "),s=new Array;for(var o=i.length;o>0;)i[--o]!=t&&(s[s.length]=i[o]);r.className=s.join(" ")}},Toolbox.hasClass=function(e,t){if(e==null||e.className==null)return null;var n=e.className.split(" ");for(var r=n.length;r>0;)if(n[--r]==t)return!0;return!1},Toolbox.toggleClass=function(e,t){Toolbox.hasClass(e,t)===!0?Toolbox.removeClass(e,t):Toolbox.addClass(e,t)},Toolbox.getElement=function(e,t){return t!=null?t.querySelector(e):document.querySelector(e)},Toolbox.getAllElements=function(e,t){return t!=null?t.querySelectorAll(e):document.querySelectorAll(e)},Toolbox.getElementsByClass=function(e,t){t||(t=document);var n=t.getElementsByTagName("*"),r=-1,i,s=[];while(i=n[++r])(" "+(i["class"]||i.className)+" ").indexOf(" "+e+" ")>-1&&s.push(i);return s},Toolbox.getAttribute=function(e,t){if(e==null){console&&console.log("Called getAttribute with null element"),console&&console.trace();return}if(e.attributes==null){console&&console.log("Called getAttribute with invalid element that does not have attributes"),console&&console.trace();return}if(typeof e.getAttribute=="function")return e.getAttribute(t);for(var n=0;n<e.attributes.length;n++)if(e.attributes[n].nodeName==t)return e.attributes[n].value;return null},Toolbox.setAttribute=function(e,t,n){if(e==null){console&&console.log("Called getAttribute with null element"),console&&console.trace();return}if(e.attributes==null){console&&console.log("Called getAttribute with invalid element that does not have attributes"),console&&console.trace();return}if(typeof e.setAttribute=="function"){e.setAttribute(t,n);var r=e.getAttribute(t);if(r!=n&&e.attributes==null){console&&console.log("ERROR: Failure to setAttribute and retrieve back value");return}}else e[t]=n;return!0},Toolbox.onEvent=function(e,t,n){var r=[];if(t==null){console&&console.log("ERROR: Toolbox.onEvent with null element");return}if(t.length==null||t.value!=null)t=[t];for(var i=0;i<t.length;i++){var s=t[i];if(s.attachEvent){var o=function(e){return function(t){t.currentTarget=e,n.call(e,t)}},u=o(s);s.attachEvent("on"+e,u);var a=function(e,t,n){return function(){e.detachEvent("on"+t,n)}};r.push(a(s,e,u))}else if(s.addEventListener){s.addEventListener(e,n,!1);var a=function(e,t,n){return function(){e.removeEventListener(t,n,!1)}};r.push(a(s,e,n))}else{s["on"+e]=n;var a=function(e,t){return function(){e["on"+t]=null}};r.push(a(s,e))}}return r},Toolbox.onClick=function(e,t){return Toolbox.onEvent("click",e,t)},Toolbox.onChange=function(e,t){return Toolbox.onEvent("change",e,t)},Toolbox.onSelectChange=function(e,t){var n=Toolbox.onEvent("keyup",e,t);return n.push.apply(n,Toolbox.onEvent("change",e,t)),n},Toolbox.Replace=function(html,model){for(;;){var nextLogic=html.indexOf("%%if"),nextLoop=html.indexOf("%%loop");if(nextLoop>0&&(nextLogic>nextLoop||nextLogic==-1)){var loop=html.match(/%%loop ?\( ?(((?!%%).)*) ?\) ?%%(((?!%%end%%)[\S\s])*)%%end%%/);if(loop&&loop.length&&loop.length>=5){var myArray=model[loop[1]];if(Object.prototype.toString.call(model[loop[1]])==="[object Array]"){var chunks="";for(var level2 in model[loop[1]]){var chunk=Toolbox.Replace(loop[3],model[loop[1]][level2]);chunks+=chunk}html=html.replace(loop[0],chunks)}else html=html.replace(loop[0],"")}}var logic=html.match(/%%if ?(((?!%%).)*)%%(((?!%%endif%%).)*)%%endif%%/);if(logic&&logic.length&&logic.length>=5){logic[1]=logic[1].replace(/&amp;/g,"&");var result=eval(logic[1]);if(result){var chunk=Toolbox.Replace(logic[3],model);html=html.replace(logic[0],chunk)}else html=html.replace(logic[0],"")}else{nextLoop=html.indexOf("%%loop");if(nextLoop==-1)break}}return html=Toolbox.ReplacePlain(html,model),html},Toolbox.ReplacePlain=function(e,t){var n;for(var r in t)if(typeof t[r]=="object")for(var i in t[r])if(Object.prototype.toString.call(t[r])==="[object Array]")if(typeof t[r][i]=="object")for(var s in t[r][i])n=new RegExp("%%"+r+"\\["+i+"\\]\\."+s+"%%","g"),e=e.replace(n,t[r][i][s]);else n=new RegExp("%%"+r+"\\["+i+"\\]%%","g"),e=e.replace(n,t[r][i]);else n=new RegExp("%%"+r+"\\."+i+"%%","g"),e=e.replace(n,t[r][i]);else n=new RegExp("%%"+r+"%%","g"),e=e.replace(n,t[r]);return e},Toolbox.ReplaceInPlace=function(e,t,n){var r;n==null&&(n="");for(var i in t)if(Object.prototype.toString.call(t[i])==="[object Array]")for(var s in t[i])Toolbox.ReplaceInPlace(e,t[i][s],n+i+"["+s+"].");else if(typeof t[i]=="object")Toolbox.ReplaceInPlace(e,t[i],n+i+".");else{var o='data-target="'+n+i,u=Toolbox.getAllElements("["+o+'"]',e);u.length>0&&Toolbox.innerHTML(u,t[i])}},Toolbox.innerHTML=function(e,t){if(e==null){console&&console.log("ERROR: Toolbox.innerHTML with null element");return}if(e.length==null||e.value!=null)e=[e];for(var n=0;n<e.length;n++){var r=e[n];r.innerHTML=t}return e},Toolbox.jsonp=function(e,t){var n=document.head||document.documentElement,r=document.createElement("script");r.async=!0,r.charset="utf-8",r.callbackName="uiToolbox"+(Math.random()*12).toString().replace(".","");var i=e.match(/callback=([^&]*)/);i?r.callbackName=i:(e.indexOf("?")==-1?e+="?":e+="&",e+="callback="+r.callbackName,window[r.callbackName]=function(e){t(e)},setTimeout(function(){if(r==null)return;window[r.callbackName]=null},3e4)),r.src=e,r.onload=r.onreadystatechange=function(){if(!r.readyState||/loaded|complete/.test(r.readyState))r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),window[r.callbackName]=null,r=null},r.abort=function(){r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),window[r.callbackName]=null,r=null},n.insertBefore(r,n.firstChild)},Toolbox.ajax=function(e){var t=!1;if(typeof XMLHttpRequest!="undefined")try{t=new XMLHttpRequest}catch(n){t=!1}if(t===!1&&window.createRequest)try{t=window.createRequest()}catch(n){t=!1}t===!1;if(t===!1)return!1;var r=(new Date).getTime();requestString+="&_t="+r,spanDebug&&(spanDebug.innerHTML=g_time_request+" HTTP request ready to be sent<br>\n"),spanDebug&&(spanDebug.innerHTML+=requestString+"<br>\n"),e.jsonp===!0;var i=!0;t.open("GET",requestString,i),t.onreadystatechange=function(){t.readyState==4};try{t.send(null)}catch(n){console&&console.log("[xmlhttp] Error send(): "+n)}},Toolbox});